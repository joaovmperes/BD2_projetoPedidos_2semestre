--BD2 - 2o Bim -Atividade de SQL - Exerc�cios de DML - Insert - Incluindo dados na tabela ITEM_PRODUTO do Projeto Pedido - Inser��o parte 2
SAVEPOINT P1;
SELECT * FROM ITEM_PRODUTO;
SELECT * FROM PEDIDO;

SELECT * FROM PEDIDO WHERE MOD(PEDIDO.NUMERO, 2)=0 AND EXTRACT(YEAR FROM PEDIDO.DATA)<2018;

SELECT * FROM PEDIDO WHERE MOD(PEDIDO.NUMERO, 2)=1 AND EXTRACT(YEAR FROM PEDIDO.DATA)=2018;

SELECT * FROM PEDIDO WHERE PEDIDO.CEP IS NULL AND EXTRACT(YEAR FROM PEDIDO.DATA)=2017;

SELECT * FROM PEDIDO WHERE PEDIDO.CEP IS NOT NULL AND MOD(EXTRACT(DAY FROM PEDIDO.DATA),2)=1;

--1
INSERT INTO ITEM_PRODUTO(CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)

SELECT 
207, 
NUMERO,
100,
10,
NULL
FROM PEDIDO WHERE MOD(PEDIDO.NUMERO, 2)=0 AND EXTRACT(YEAR FROM PEDIDO.DATA)<2018;

--2
INSERT INTO ITEM_PRODUTO (CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)
SELECT
206,
NUMERO,
50,
12,
NULL
FROM PEDIDO WHERE MOD(PEDIDO.NUMERO, 2)=1 AND EXTRACT(YEAR FROM PEDIDO.DATA)=2018;

--3
INSERT INTO ITEM_PRODUTO (CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)
SELECT
207,
NUMERO,
150,
14,
NULL
FROM PEDIDO WHERE MOD(PEDIDO.NUMERO, 2)=0 AND EXTRACT(YEAR FROM PEDIDO.DATA)=2018;

--4
INSERT INTO ITEM_PRODUTO (CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)
SELECT
206,
NUMERO,
200,
8,
NULL
FROM PEDIDO WHERE MOD(PEDIDO.NUMERO, 2)=1 AND EXTRACT(YEAR FROM PEDIDO.DATA)<2018;

--5
INSERT INTO ITEM_PRODUTO (CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)
SELECT
208,
NUMERO,
80,
18,
NULL
FROM PEDIDO WHERE PEDIDO.CEP IS NULL AND EXTRACT(YEAR FROM PEDIDO.DATA)=2017;

--6
INSERT INTO ITEM_PRODUTO (CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)
SELECT
208,
NUMERO,
70,
20,
NULL
FROM PEDIDO WHERE PEDIDO.CEP IS NULL AND EXTRACT(YEAR FROM PEDIDO.DATA)=2018;

--7
INSERT INTO ITEM_PRODUTO (CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)
SELECT
202,
NUMERO,
60,
15,
NULL
FROM PEDIDO WHERE PEDIDO.CEP IS NOT NULL AND MOD(EXTRACT(DAY FROM PEDIDO.DATA),2)=1;

--8
INSERT INTO ITEM_PRODUTO (CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)
SELECT
205,
NUMERO,
90,
11.50,
NULL
FROM PEDIDO WHERE PEDIDO.CEP IS NOT NULL AND MOD(EXTRACT(DAY FROM PEDIDO.DATA),2)=0;

--9
INSERT INTO ITEM_PRODUTO (CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)
SELECT
203,
NUMERO,
550,
21.35,
NULL
FROM PEDIDO WHERE PEDIDO.CEP IS NOT NULL AND MOD(EXTRACT(DAY FROM PEDIDO.DATA),2)=1;

INSERT INTO ITEM_PRODUTO (CODIGO_PRO,NUMERO_PED, QUANTIDADE, PRECO_UNITARIO, VALOR_ITEM)
SELECT
204,
NUMERO,
150,
25.85,
NULL
FROM PEDIDO WHERE PEDIDO.CEP IS NULL AND MOD(EXTRACT(DAY FROM PEDIDO.DATA),2)=0;

ROLLBACK TO P1;